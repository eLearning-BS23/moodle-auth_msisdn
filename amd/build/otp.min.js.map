{"version":3,"sources":["../src/otp.js"],"names":["define","$","document","ready","click","phone","val","test","timer","remaining","m","Math","floor","s","getElementById","innerHTML","setTimeout","alert","removeAttr","attr","ajax","url","method","data","success","removeClass"],"mappings":"AAuBAA,OAAM,gBAAC,CAAC,QAAD,CAAU,mBAAV,CAAD,CAAiC,SAASC,CAAT,CAAY,CAC/CA,CAAC,CAACC,QAAD,CAAD,CAAYC,KAAZ,CAAkB,SAAUF,CAAV,CAA0B,CACxCA,CAAC,CAAE,UAAF,CAAD,CAAgBG,KAAhB,CAAsB,UAAW,CAC7B,GAAIC,CAAAA,CAAK,CAAGJ,CAAC,CAAC,QAAD,CAAD,CAAYK,GAAZ,EAAZ,CACA,GAAGD,CAAH,CAAS,CAEL,GADc,UACV,CAAQE,IAAR,CAAaF,CAAb,CAAJ,CACA,IAGaG,CAAAA,CAHb,CAGI,SAAeC,CAAf,CAA0B,IAClBC,CAAAA,CAAC,CAAGC,IAAI,CAACC,KAAL,CAAWH,CAAS,CAAG,EAAvB,CADc,CAElBI,CAAC,CAAGJ,CAAS,CAAG,EAFE,CAGtBC,CAAC,CAAO,EAAJ,CAAAA,CAAC,CAAQ,IAAMA,CAAd,CAAkBA,CAAvB,CACAG,CAAC,CAAO,EAAJ,CAAAA,CAAC,CAAQ,IAAMA,CAAd,CAAkBA,CAAvB,CACAX,QAAQ,CAACY,cAAT,CAAwB,OAAxB,EAAiCC,SAAjC,CAA6CL,CAAC,CAAG,GAAJ,CAAUG,CAAvD,CACAJ,CAAS,EAAI,CAAb,CACA,GAAgB,CAAb,EAAAA,CAAS,IAAZ,CAA8B,CAC1BO,UAAU,CAAC,UAAW,CAClBR,CAAK,CAACC,CAAD,CACR,CAFS,CAEP,GAFO,CAAV,CAGA,MACH,CAMDQ,KAAK,CAAC,iBAAD,CAAL,CACAhB,CAAC,CAAC,UAAD,CAAD,CAAciB,UAAd,CAAyB,UAAzB,EACAhB,QAAQ,CAACY,cAAT,CAAwB,OAAxB,EAAiCC,SAAjC,CAA4C,aAC/C,CAxBL,CACId,CAAC,CAAC,UAAD,CAAD,CAAckB,IAAd,CAAmB,UAAnB,CAA8B,UAA9B,EAwBAX,CAAK,CAAC,GAAD,CAAL,CACAP,CAAC,CAACmB,IAAF,CAAO,CACHC,GAAG,CAAE,eADF,CAEHC,MAAM,CAAE,MAFL,CAGHC,IAAI,CAAE,CAAClB,KAAK,CAAEA,CAAR,CAHH,CAIHmB,OAAO,CAAE,kBAAgB,CACrBvB,CAAC,CAAC,YAAD,CAAD,CAAgBwB,WAAhB,CAA4B,QAA5B,CACH,CANE,CAAP,CAQH,CAnCD,IAqCA,CACI,QACH,CACJ,CACJ,CA7CD,CA8CH,CA/CD,CAgDH,CAjDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for the \"Actions\" panel at the bottom of the page.\n *\n * @module     auth_otp/otp\n * @copyright  2021 Brain station 23 <damyon@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.1\n */\ndefine(['jquery','core/notification'], function($) {\n    $(document).ready(function ($,notification) {\n        $( \"#sendotp\" ).click(function() {\n            var phone = $('#phone').val();\n            if(phone){\n                var phoneno = /^\\d{10}$/;\n                if((phoneno.test(phone)))\n                {\n                    $('#sendotp').attr('disabled','disabled');\n                    let timerOn = true;\n                    function timer(remaining) {\n                        var m = Math.floor(remaining / 60);\n                        var s = remaining % 60;\n                        m = m < 10 ? '0' + m : m;\n                        s = s < 10 ? '0' + s : s;\n                        document.getElementById('timer').innerHTML = m + ':' + s;\n                        remaining -= 1;\n                        if(remaining >= 0 && timerOn) {\n                            setTimeout(function() {\n                                timer(remaining);\n                            }, 1000);\n                            return;\n                        }\n                        if(!timerOn) {\n                            // Do validate stuff here\n                            return;\n                        }\n                        // Do timeout stuff here\n                        alert('Timeout for otp');\n                        $('#sendotp').removeAttr('disabled');\n                        document.getElementById('timer').innerHTML ='Resend Code';\n                    }\n                    timer(300);\n                    $.ajax({\n                        url: \"handleotp.php\",\n                        method: \"POST\",\n                        data: {phone: phone},\n                        success: function (data) {\n                            $('#otp-field').removeClass('d-none');\n                        }\n                    });\n                }\n                else\n                {\n                    return false;\n                }\n            }\n        });\n    });\n});"],"file":"otp.min.js"}